scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
names(scen1)
names(scen2)
names(scen3)
names(scen4)
names(scen5)
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
getwd()
## Input Values
cmatrix_basin = read.csv("basin_results/nondominated_basin7choices.csv",header=T)
cmatrix_basin$Payment_M1 = 0.0
head(cmatrix_basin)
c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
getwd()
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
#Napp = data.frame(out$N210_Napp,out$N180_Napp,out$N120_Napp,out$N060_Napp)
#names(Napp) <- c("N210","N180","N120","N060")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_basin = read.csv("basin_results/nondominated_basin7choices.csv",header=T)
cmatrix_basin$Payment_M1 = 0.0
# Current Individual (Wrap in Loop)
for (indiv in 1:length(cmatrix_basin[,1])) {
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
for (i in 1:4020) {
temp = max(scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],
scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],
scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],
scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],
scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],
scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],
scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]
)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i], scen5$gm[i], scen6$gm[i], scen7$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 150; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice = 120; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp_np == scen5$gm[i]) { np_choice =  90; np_gm = scen5$gm[i]; np_nloss = scen5$loss[i] }
if (temp_np == scen6$gm[i]) { np_choice =  60; np_gm = scen6$gm[i]; np_nloss = scen6$loss[i] }
if (temp_np == scen7$gm[i]) { np_choice =  40; np_gm = scen7$gm[i]; np_nloss = scen7$loss[i] }
if (temp == scen1$gm[i]+cmatrix_basin$Payment_M1[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i])
if (temp == scen2$gm[i]+cmatrix_basin$Payment_M2[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i])
if (temp == scen3$gm[i]+cmatrix_basin$Payment_M3[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],150,cmatrix_basin$Payment_M3[indiv],scen3$gm[i],scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i])
if (temp == scen4$gm[i]+cmatrix_basin$Payment_M4[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,cmatrix_basin$Payment_M4[indiv],scen4$gm[i],scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i])
if (temp == scen5$gm[i]+cmatrix_basin$Payment_M5[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],90,cmatrix_basin$Payment_M5[indiv],scen5$gm[i],scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],out$FlowDist_m[i],scen5$loss[i],np_choice,np_gm,np_nloss,scen5$sol1[i],scen5$sol2[i],scen5$sol3[i],scen5$sol4[i])
if (temp == scen6$gm[i]+cmatrix_basin$Payment_M6[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,cmatrix_basin$Payment_M6[indiv],scen6$gm[i],scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],out$FlowDist_m[i],scen6$loss[i],np_choice,np_gm,np_nloss,scen6$sol1[i],scen6$sol2[i],scen6$sol3[i],scen6$sol4[i])
if (temp == scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],40,cmatrix_basin$Payment_M7[indiv],scen7$gm[i],scen7$gm[i]+cmatrix_basin$Payment_M7[indiv],out$FlowDist_m[i],scen7$loss[i],np_choice,np_gm,np_nloss,scen7$sol1[i],scen7$sol2[i],scen7$sol3[i],scen7$sol4[i])
rm(temp, temp_np, np_choice, np_gm, np_napp, np_nloss)
}
write.csv(output_df,paste("basin_results//outputs_alldata_basin//soln_",indiv,".csv",sep=""),quote=F,row.names=F)
}
rm(list=ls())
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
#Napp = data.frame(out$N210_Napp,out$N180_Napp,out$N120_Napp,out$N060_Napp)
#names(Napp) <- c("N210","N180","N120","N060")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_basin = read.csv("basin_results/nondominated_basin7choices.csv",header=T)
cmatrix_basin$Payment_M1 = 0.0
indiv = 1
length(cmatrix_basin[,1])
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
i = 1
temp = max(scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],
scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],
scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],
scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],
scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],
scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],
scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]
)
temp
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i], scen5$gm[i], scen6$gm[i], scen7$gm[i])
temp_np
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 150; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice = 120; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp_np == scen5$gm[i]) { np_choice =  90; np_gm = scen5$gm[i]; np_nloss = scen5$loss[i] }
if (temp_np == scen6$gm[i]) { np_choice =  60; np_gm = scen6$gm[i]; np_nloss = scen6$loss[i] }
if (temp_np == scen7$gm[i]) { np_choice =  40; np_gm = scen7$gm[i]; np_nloss = scen7$loss[i] }
np_choice
if (temp == scen1$gm[i]+cmatrix_basin$Payment_M1[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i])
if (temp == scen2$gm[i]+cmatrix_basin$Payment_M2[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i])
if (temp == scen3$gm[i]+cmatrix_basin$Payment_M3[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],150,cmatrix_basin$Payment_M3[indiv],scen3$gm[i],scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i])
if (temp == scen4$gm[i]+cmatrix_basin$Payment_M4[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,cmatrix_basin$Payment_M4[indiv],scen4$gm[i],scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i])
if (temp == scen5$gm[i]+cmatrix_basin$Payment_M5[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],90,cmatrix_basin$Payment_M5[indiv],scen5$gm[i],scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],out$FlowDist_m[i],scen5$loss[i],np_choice,np_gm,np_nloss,scen5$sol1[i],scen5$sol2[i],scen5$sol3[i],scen5$sol4[i])
if (temp == scen6$gm[i]+cmatrix_basin$Payment_M6[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,cmatrix_basin$Payment_M6[indiv],scen6$gm[i],scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],out$FlowDist_m[i],scen6$loss[i],np_choice,np_gm,np_nloss,scen6$sol1[i],scen6$sol2[i],scen6$sol3[i],scen6$sol4[i])
if (temp == scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],40,cmatrix_basin$Payment_M7[indiv],scen7$gm[i],scen7$gm[i]+cmatrix_basin$Payment_M7[indiv],out$FlowDist_m[i],scen7$loss[i],np_choice,np_gm,np_nloss,scen7$sol1[i],scen7$sol2[i],scen7$sol3[i],scen7$sol4[i])
cmatrix_basin$Payment_M1[indiv]
scen1$gm[i]
head(output_df)
rm(output_df)
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
output_df
i = 1
temp = max(scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],
scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],
scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],
scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],
scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],
scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],
scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]
)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i], scen5$gm[i], scen6$gm[i], scen7$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 150; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice = 120; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp_np == scen5$gm[i]) { np_choice =  90; np_gm = scen5$gm[i]; np_nloss = scen5$loss[i] }
if (temp_np == scen6$gm[i]) { np_choice =  60; np_gm = scen6$gm[i]; np_nloss = scen6$loss[i] }
if (temp_np == scen7$gm[i]) { np_choice =  40; np_gm = scen7$gm[i]; np_nloss = scen7$loss[i] }
output_df
scen1$gm[i]+cmatrix_basin$Payment_M1[indiv]
temp
c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i])
length(c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i]))
length(c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i]))
c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i])
c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i])
c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i])
out$Cellno[i]
cmatrix_basin$Payment_M2[indiv]
out = read.csv("basin_results/nondominated_basin7choices.csv")
plot(out$V3,out$V4)
plot(out$V5
)
plot(out$V6)
plot(out$V7)
plot(out$V8)
plot(out$V9)
plot(out$V10)
cmatrix_basin
head(cmatrix_basin)
rm(list=ls())
## Basinwide
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
#Napp = data.frame(out$N210_Napp,out$N180_Napp,out$N120_Napp,out$N060_Napp)
#names(Napp) <- c("N210","N180","N120","N060")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_basin = read.csv("basin_results/nondominated_basin7choices.csv",header=T)
cmatrix_basin$Payment_M1 = 0.0
cmatrix_basin$Payment_M2 = cmatrix_basin$V5
cmatrix_basin$Payment_M3 = cmatrix_basin$V6
cmatrix_basin$Payment_M4 = cmatrix_basin$V7
cmatrix_basin$Payment_M5 = cmatrix_basin$V8
cmatrix_basin$Payment_M6 = cmatrix_basin$V9
cmatrix_basin$Payment_M7 = cmatrix_basin$V10
# Current Individual (Wrap in Loop)
for (indiv in 1:length(cmatrix_basin[,1])) {
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2')
for (i in 1:4020) {
temp = max(scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],
scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],
scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],
scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],
scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],
scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],
scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]
)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i], scen5$gm[i], scen6$gm[i], scen7$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 150; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice = 120; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp_np == scen5$gm[i]) { np_choice =  90; np_gm = scen5$gm[i]; np_nloss = scen5$loss[i] }
if (temp_np == scen6$gm[i]) { np_choice =  60; np_gm = scen6$gm[i]; np_nloss = scen6$loss[i] }
if (temp_np == scen7$gm[i]) { np_choice =  40; np_gm = scen7$gm[i]; np_nloss = scen7$loss[i] }
if (temp == scen1$gm[i]+cmatrix_basin$Payment_M1[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,cmatrix_basin$Payment_M1[indiv],scen1$gm[i],scen1$gm[i]+cmatrix_basin$Payment_M1[indiv],out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i])
if (temp == scen2$gm[i]+cmatrix_basin$Payment_M2[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,cmatrix_basin$Payment_M2[indiv],scen2$gm[i],scen2$gm[i]+cmatrix_basin$Payment_M2[indiv],out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i])
if (temp == scen3$gm[i]+cmatrix_basin$Payment_M3[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],150,cmatrix_basin$Payment_M3[indiv],scen3$gm[i],scen3$gm[i]+cmatrix_basin$Payment_M3[indiv],out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i])
if (temp == scen4$gm[i]+cmatrix_basin$Payment_M4[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,cmatrix_basin$Payment_M4[indiv],scen4$gm[i],scen4$gm[i]+cmatrix_basin$Payment_M4[indiv],out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i])
if (temp == scen5$gm[i]+cmatrix_basin$Payment_M5[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],90,cmatrix_basin$Payment_M5[indiv],scen5$gm[i],scen5$gm[i]+cmatrix_basin$Payment_M5[indiv],out$FlowDist_m[i],scen5$loss[i],np_choice,np_gm,np_nloss,scen5$sol1[i],scen5$sol2[i],scen5$sol3[i],scen5$sol4[i])
if (temp == scen6$gm[i]+cmatrix_basin$Payment_M6[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,cmatrix_basin$Payment_M6[indiv],scen6$gm[i],scen6$gm[i]+cmatrix_basin$Payment_M6[indiv],out$FlowDist_m[i],scen6$loss[i],np_choice,np_gm,np_nloss,scen6$sol1[i],scen6$sol2[i],scen6$sol3[i],scen6$sol4[i])
if (temp == scen7$gm[i]+cmatrix_basin$Payment_M7[indiv]) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],40,cmatrix_basin$Payment_M7[indiv],scen7$gm[i],scen7$gm[i]+cmatrix_basin$Payment_M7[indiv],out$FlowDist_m[i],scen7$loss[i],np_choice,np_gm,np_nloss,scen7$sol1[i],scen7$sol2[i],scen7$sol3[i],scen7$sol4[i])
rm(temp, temp_np, np_choice, np_gm, np_napp, np_nloss)
}
write.csv(output_df,paste("basin_results//outputs_alldata_basin//soln_",indiv,".csv",sep=""),quote=F,row.names=F)
}
warnings()
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
rm(list=ls())
#Soil specific
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
#No Napp data in the new FullData dataset.
#Napp = data.frame(out$N210_Napp,out$N180_Napp,out$N120_Napp,out$N060_Napp)
#names(Napp) <- c("N210","N180","N120","N060")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
# Current Individual (Wrap in Loop)
for (indiv in 1:length(cmatrix_soil[,1])) {
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2','pay_per_m2_sol1','pay_per_m2_sol2','pay_per_m2_sol3','pay_per_m2_sol4')
for (i in 1:4020) {
incen1 = 0.0
incen2 = cmatrix_soil[indiv,3]*scen2$sol1[i] + cmatrix_soil[indiv,4]*scen2$sol2[i] + cmatrix_soil[indiv,5]*scen2$sol3[i] + cmatrix_soil[indiv,6]*scen2$sol4[i]
incen3 = cmatrix_soil[indiv,7]*scen3$sol1[i] + cmatrix_soil[indiv,8]*scen3$sol2[i] + cmatrix_soil[indiv,9]*scen3$sol3[i] + cmatrix_soil[indiv,10]*scen3$sol4[i]
incen4 = cmatrix_soil[indiv,11]*scen4$sol1[i] + cmatrix_soil[indiv,12]*scen4$sol2[i] + cmatrix_soil[indiv,13]*scen4$sol3[i] + cmatrix_soil[indiv,14]*scen4$sol4[i]
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 120; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice =  60; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp == scen1$gm[i]+incen1) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,incen1,scen1$gm[i],scen1$gm[i]+incen1,out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i],0.0,0.0,0.0,0.0)
if (temp == scen2$gm[i]+incen2) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,incen2,scen2$gm[i],scen2$gm[i]+incen2,out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i],cmatrix_soil[indiv,3],cmatrix_soil[indiv,4],cmatrix_soil[indiv,5],cmatrix_soil[indiv,6])
if (temp == scen3$gm[i]+incen3) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,incen3,scen3$gm[i],scen3$gm[i]+incen3,out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i],cmatrix_soil[indiv,7],cmatrix_soil[indiv,8],cmatrix_soil[indiv,9],cmatrix_soil[indiv,10])
if (temp == scen4$gm[i]+incen4) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,incen4,scen4$gm[i],scen4$gm[i]+incen4,out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i],cmatrix_soil[indiv,11],cmatrix_soil[indiv,12],cmatrix_soil[indiv,13],cmatrix_soil[indiv,14])
rm(incen1, incen2, incen3, incen4, temp, temp_np, np_choice, np_gm, np_nloss)
}
write.csv(output_df,paste("soil_results//outputs_alldata_soil//soln_",indiv,".csv",sep=""),quote=F,row.names=F)
}
#Soil specific
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
indiv = 1
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2','pay_per_m2_sol1','pay_per_m2_sol2','pay_per_m2_sol3','pay_per_m2_sol4')
for (i in 1:4020) {
incen1 = 0.0
incen2 = cmatrix_soil[indiv,3]*scen2$sol1[i] + cmatrix_soil[indiv,4]*scen2$sol2[i] + cmatrix_soil[indiv,5]*scen2$sol3[i] + cmatrix_soil[indiv,6]*scen2$sol4[i]
incen3 = cmatrix_soil[indiv,7]*scen3$sol1[i] + cmatrix_soil[indiv,8]*scen3$sol2[i] + cmatrix_soil[indiv,9]*scen3$sol3[i] + cmatrix_soil[indiv,10]*scen3$sol4[i]
incen4 = cmatrix_soil[indiv,11]*scen4$sol1[i] + cmatrix_soil[indiv,12]*scen4$sol2[i] + cmatrix_soil[indiv,13]*scen4$sol3[i] + cmatrix_soil[indiv,14]*scen4$sol4[i]
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 120; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice =  60; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp == scen1$gm[i]+incen1) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,incen1,scen1$gm[i],scen1$gm[i]+incen1,out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i],0.0,0.0,0.0,0.0)
if (temp == scen2$gm[i]+incen2) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,incen2,scen2$gm[i],scen2$gm[i]+incen2,out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i],cmatrix_soil[indiv,3],cmatrix_soil[indiv,4],cmatrix_soil[indiv,5],cmatrix_soil[indiv,6])
if (temp == scen3$gm[i]+incen3) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,incen3,scen3$gm[i],scen3$gm[i]+incen3,out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i],cmatrix_soil[indiv,7],cmatrix_soil[indiv,8],cmatrix_soil[indiv,9],cmatrix_soil[indiv,10])
if (temp == scen4$gm[i]+incen4) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,incen4,scen4$gm[i],scen4$gm[i]+incen4,out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i],cmatrix_soil[indiv,11],cmatrix_soil[indiv,12],cmatrix_soil[indiv,13],cmatrix_soil[indiv,14])
rm(incen1, incen2, incen3, incen4, temp, temp_np, np_choice, np_gm, np_nloss)
}
indiv = 2
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2','pay_per_m2_sol1','pay_per_m2_sol2','pay_per_m2_sol3','pay_per_m2_sol4')
for (i in 1:4020) {
incen1 = 0.0
incen2 = cmatrix_soil[indiv,3]*scen2$sol1[i] + cmatrix_soil[indiv,4]*scen2$sol2[i] + cmatrix_soil[indiv,5]*scen2$sol3[i] + cmatrix_soil[indiv,6]*scen2$sol4[i]
incen3 = cmatrix_soil[indiv,7]*scen3$sol1[i] + cmatrix_soil[indiv,8]*scen3$sol2[i] + cmatrix_soil[indiv,9]*scen3$sol3[i] + cmatrix_soil[indiv,10]*scen3$sol4[i]
incen4 = cmatrix_soil[indiv,11]*scen4$sol1[i] + cmatrix_soil[indiv,12]*scen4$sol2[i] + cmatrix_soil[indiv,13]*scen4$sol3[i] + cmatrix_soil[indiv,14]*scen4$sol4[i]
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 120; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice =  60; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp == scen1$gm[i]+incen1) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,incen1,scen1$gm[i],scen1$gm[i]+incen1,out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i],0.0,0.0,0.0,0.0)
if (temp == scen2$gm[i]+incen2) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,incen2,scen2$gm[i],scen2$gm[i]+incen2,out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i],cmatrix_soil[indiv,3],cmatrix_soil[indiv,4],cmatrix_soil[indiv,5],cmatrix_soil[indiv,6])
if (temp == scen3$gm[i]+incen3) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,incen3,scen3$gm[i],scen3$gm[i]+incen3,out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i],cmatrix_soil[indiv,7],cmatrix_soil[indiv,8],cmatrix_soil[indiv,9],cmatrix_soil[indiv,10])
if (temp == scen4$gm[i]+incen4) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,incen4,scen4$gm[i],scen4$gm[i]+incen4,out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i],cmatrix_soil[indiv,11],cmatrix_soil[indiv,12],cmatrix_soil[indiv,13],cmatrix_soil[indiv,14])
rm(incen1, incen2, incen3, incen4, temp, temp_np, np_choice, np_gm, np_nloss)
}
i
incen1 = 0.0
incen2 = cmatrix_soil[indiv,3]*scen2$sol1[i] + cmatrix_soil[indiv,4]*scen2$sol2[i] + cmatrix_soil[indiv,5]*scen2$sol3[i] + cmatrix_soil[indiv,6]*scen2$sol4[i]
incen3 = cmatrix_soil[indiv,7]*scen3$sol1[i] + cmatrix_soil[indiv,8]*scen3$sol2[i] + cmatrix_soil[indiv,9]*scen3$sol3[i] + cmatrix_soil[indiv,10]*scen3$sol4[i]
incen4 = cmatrix_soil[indiv,11]*scen4$sol1[i] + cmatrix_soil[indiv,12]*scen4$sol2[i] + cmatrix_soil[indiv,13]*scen4$sol3[i] + cmatrix_soil[indiv,14]*scen4$sol4[i]
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 120; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice =  60; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp == scen1$gm[i]+incen1) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,incen1,scen1$gm[i],scen1$gm[i]+incen1,out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i],0.0,0.0,0.0,0.0)
output_df
temp == scen1$gm[i]+incen1
scen1$gm[i]
scen1$gm[i]+incen1
temp
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp
scen1$gm[i]+incen1
scen2$gm[i]+incen2
incen2
head(cmatrix_soil)
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
head(cmatrix_soil)
a = cmatrix_soil[complete.cases(cmatrix_soil),]
head(a)
a
26/4
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
head(cmatrix_soil)
library(nsga2R)
##Code to get only nondominated solutions
setwd("C:\\Users\\BBarnhart.DOMAIN1\\OneDrive - National Council for Air and Stream Improvement Inc\\Projects\\Other\\Legacy\\brisbane\\7_choices_updated")
soil = read.csv('soil_results\\inspyred-individuals-file-08072019-155742.csv',header=F)
b = fastNonDominatedSorting(cbind(soil$V3,soil$V4))
nondominated_soil = soil[b[[1]],]
soil_out = unique(nondominated_soil[,3:28])
head(soil_out)
soil = read.csv('soil_results\\inspyred-individuals-file-08072019-155742.csv',header=F)
head(soil)
plot(out$V3,out$V4)
out = out[complete.cases(out),]
head(out)
soil = soil[complete.cases(soil),]
head(soil)
b = fastNonDominatedSorting(cbind(soil$V3,soil$V4))
nondominated_soil = soil[b[[1]],]
soil_out = unique(nondominated_soil[,3:28])
head(soil_out)
setwd("C:\\Users\\bbarnhart.DOMAIN1\\OneDrive - National Council for Air and Stream Improvement Inc\\Projects\\Other\\Legacy\\brisbane\\7_choices_updated\\Tully_Bilevel")
write.csv(soil_out,"soil_results\\nondominated_soil7choices.csv",quote=F,row.names=F)
plot(soil_out$V3,soil_out$V4)
#Soil specific
#Data Preparation
setwd("C:/Users/BBarnhart.DOMAIN1/OneDrive - National Council for Air and Stream Improvement Inc/Projects/Other/Legacy/brisbane/7_choices_updated/Tully_Bilevel")
out = read.csv("FullData.csv")
#No Napp data in the new FullData dataset.
#Napp = data.frame(out$N210_Napp,out$N180_Napp,out$N120_Napp,out$N060_Napp)
#names(Napp) <- c("N210","N180","N120","N060")
Nloss = data.frame(out$N210_Nloss,out$N180_Nloss,out$N150_Nloss,out$N120_Nloss,out$N090_Nloss,out$N060_Nloss,out$N040_Nloss)
names(Nloss) <- c("N210","N180","N150","N120","N090","N060","N040")
GM = data.frame(out$N210_GM,out$N180_GM,out$N150_GM,out$N120_GM,out$N090_GM,out$N060_GM,out$N040_GM)
names(GM) <- c("N210","N180","N150","N120","N090","N060","N040")
flowdist = data.frame(out$FlowDist_m)
names(flowdist) <- c("flowdist")
scen1 = data.frame(out$Cellno,out$FlowDist_m,out$N210_Nloss,out$N210_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,210)
names(scen1) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen2 = data.frame(out$Cellno,out$FlowDist_m,out$N180_Nloss,out$N180_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,180)
names(scen2) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen3 = data.frame(out$Cellno,out$FlowDist_m,out$N150_Nloss,out$N150_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,150)
names(scen3) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen4 = data.frame(out$Cellno,out$FlowDist_m,out$N120_Nloss,out$N120_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,120)
names(scen4) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen5 = data.frame(out$Cellno,out$FlowDist_m,out$N090_Nloss,out$N090_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,90)
names(scen5) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen6 = data.frame(out$Cellno,out$FlowDist_m,out$N060_Nloss,out$N060_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,60)
names(scen6) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
scen7 = data.frame(out$Cellno,out$FlowDist_m,out$N040_Nloss,out$N040_GM,out$SolCls1m2,out$SolCls2m2,out$SolCls3m2,out$SolCls4m2,40)
names(scen7) <- c("cellno","flowdist","loss","gm",'sol1','sol2','sol3','sol4',"scenario")
combined <- rbind(scen1,scen2,scen3,scen4,scen5,scen6,scen7)
## Input Values
cmatrix_soil = read.csv("soil_results/nondominated_soil7choices.csv",header=T)
# Current Individual (Wrap in Loop)
for (indiv in 1:length(cmatrix_soil[,1])) {
output_df = data.frame(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
names(output_df) <- c('cellno','x','y','policy_choice','payment','gm','gm_and_payment','flowdist','nloss','np_choice','np_gm','np_nloss','sol1aream2','sol2aream2','sol3aream2','sol4aream2','pay_per_m2_sol1','pay_per_m2_sol2','pay_per_m2_sol3','pay_per_m2_sol4')
for (i in 1:4020) {
incen1 = 0.0
incen2 = cmatrix_soil[indiv,3]*scen2$sol1[i] + cmatrix_soil[indiv,4]*scen2$sol2[i] + cmatrix_soil[indiv,5]*scen2$sol3[i] + cmatrix_soil[indiv,6]*scen2$sol4[i]
incen3 = cmatrix_soil[indiv,7]*scen3$sol1[i] + cmatrix_soil[indiv,8]*scen3$sol2[i] + cmatrix_soil[indiv,9]*scen3$sol3[i] + cmatrix_soil[indiv,10]*scen3$sol4[i]
incen4 = cmatrix_soil[indiv,11]*scen4$sol1[i] + cmatrix_soil[indiv,12]*scen4$sol2[i] + cmatrix_soil[indiv,13]*scen4$sol3[i] + cmatrix_soil[indiv,14]*scen4$sol4[i]
temp = max(scen1$gm[i]+incen1, scen2$gm[i]+incen2, scen3$gm[i]+incen3, scen4$gm[i]+incen4)
temp_np = max(scen1$gm[i], scen2$gm[i],	scen3$gm[i], scen4$gm[i])
if (temp_np == scen1$gm[i]) { np_choice = 210; np_gm = scen1$gm[i]; np_nloss = scen1$loss[i] }
if (temp_np == scen2$gm[i]) { np_choice = 180; np_gm = scen2$gm[i]; np_nloss = scen2$loss[i] }
if (temp_np == scen3$gm[i]) { np_choice = 120; np_gm = scen3$gm[i]; np_nloss = scen3$loss[i] }
if (temp_np == scen4$gm[i]) { np_choice =  60; np_gm = scen4$gm[i]; np_nloss = scen4$loss[i] }
if (temp == scen1$gm[i]+incen1) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],210,incen1,scen1$gm[i],scen1$gm[i]+incen1,out$FlowDist_m[i],scen1$loss[i],np_choice,np_gm,np_nloss,scen1$sol1[i],scen1$sol2[i],scen1$sol3[i],scen1$sol4[i],0.0,0.0,0.0,0.0)
if (temp == scen2$gm[i]+incen2) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],180,incen2,scen2$gm[i],scen2$gm[i]+incen2,out$FlowDist_m[i],scen2$loss[i],np_choice,np_gm,np_nloss,scen2$sol1[i],scen2$sol2[i],scen2$sol3[i],scen2$sol4[i],cmatrix_soil[indiv,3],cmatrix_soil[indiv,4],cmatrix_soil[indiv,5],cmatrix_soil[indiv,6])
if (temp == scen3$gm[i]+incen3) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],120,incen3,scen3$gm[i],scen3$gm[i]+incen3,out$FlowDist_m[i],scen3$loss[i],np_choice,np_gm,np_nloss,scen3$sol1[i],scen3$sol2[i],scen3$sol3[i],scen3$sol4[i],cmatrix_soil[indiv,7],cmatrix_soil[indiv,8],cmatrix_soil[indiv,9],cmatrix_soil[indiv,10])
if (temp == scen4$gm[i]+incen4) output_df[i,] = c(out$Cellno[i],out$x[i],out$y[i],60,incen4,scen4$gm[i],scen4$gm[i]+incen4,out$FlowDist_m[i],scen4$loss[i],np_choice,np_gm,np_nloss,scen4$sol1[i],scen4$sol2[i],scen4$sol3[i],scen4$sol4[i],cmatrix_soil[indiv,11],cmatrix_soil[indiv,12],cmatrix_soil[indiv,13],cmatrix_soil[indiv,14])
rm(incen1, incen2, incen3, incen4, temp, temp_np, np_choice, np_gm, np_nloss)
}
write.csv(output_df,paste("soil_results//outputs_alldata_soil//soln_",indiv,".csv",sep=""),quote=F,row.names=F)
}
